import numpy as np

# Optional: allow running without matplotlib installed
try:
    import matplotlib.pyplot as plt
    _HAS_MATPLOTLIB = True
except ModuleNotFoundError:
    _HAS_MATPLOTLIB = False
    print("matplotlib not found ï¿½ plotting will be skipped. Install with: python -m pip install matplotlib")

# --- Parameters ---
initial_investment = 1000       # starting amount
years = 30                      # investment horizon
mean_return = 0.07              # expected annual return (7%)
volatility = 0.15               # standard deviation (15%)
num_simulations = 1000          # number of Monte Carlo trials

# --- Simulation ---
# Generate random returns: shape = (years, num_simulations)
random_returns = np.random.normal(mean_return, volatility, (years, num_simulations))

# Calculate growth paths
growth_paths = np.zeros((years + 1, num_simulations))
growth_paths[0] = initial_investment

for t in range(1, years + 1):
    growth_paths[t] = growth_paths[t-1] * (1 + random_returns[t-1])

# --- Results ---
final_values = growth_paths[-1]

# --- Summary statistics ---
mean_ending = np.mean(final_values)
median_ending = np.median(final_values)
p10 = np.percentile(final_values, 10)
p90 = np.percentile(final_values, 90)

print(f"After {years} years:")
print(f"Mean final value: ${mean_ending:,.2f}")
print(f"Median final value: ${median_ending:,.2f}")
print(f"10th percentile (bad case): ${p10:,.2f}")
print(f"90th percentile (good case): ${p90:,.2f}")

# --- Plotting ---
if _HAS_MATPLOTLIB:
    plt.figure(figsize=(10,6))
    plt.plot(growth_paths[:, :100], color='gray', alpha=0.3)  # show 100 random paths
    plt.title("Monte Carlo Simulation of $1,000 Investment Over 30 Years")
    plt.xlabel("Year")
    plt.ylabel("Portfolio Value ($)")
    plt.grid(True)
    plt.show()
else:
    print("Skipping plot (matplotlib not installed).")

